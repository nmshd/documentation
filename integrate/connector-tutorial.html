<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Connector Tutorial - Enmeshed</title>
<meta name="description" content="In this tutorial we go through the basic steps necessary to establish a Relationship to another Identity and send Messages between two Identities with an existing Relationship. This will create a better understanding of these processes, which will help you automating them for your organization.">


  <meta name="author" content="Enmeshed Team">
  
  <meta property="article:author" content="Enmeshed Team">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Enmeshed">
<meta property="og:title" content="Connector Tutorial">
<meta property="og:url" content="/integrate/connector-tutorial">


  <meta property="og:description" content="In this tutorial we go through the basic steps necessary to establish a Relationship to another Identity and send Messages between two Identities with an existing Relationship. This will create a better understanding of these processes, which will help you automating them for your organization.">







  <meta property="article:published_time" content="2022-11-23T11:36:20+01:00">






<link rel="canonical" href="/integrate/connector-tutorial">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Enmeshed Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <link href="/assets/css/overwrite.css" rel="stylesheet" type="text/css" />

<!-- The following lines are needed because otherwise Prism (the syntax highlighter RapiDoc uses) breaks Rouge (the syntax highlighter we use) -->
<script>
    window.Prism = window.Prism || {};
    Prism.manual = true;
</script>
<script type="module" src="https://unpkg.com/rapidoc/dist/rapidoc-min.js"></script>



  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Enmeshed
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/use">Use</a>
            </li><li class="masthead__menu-item">
              <a href="/explore">Explore</a>
            </li><li class="masthead__menu-item">
              <a href="/integrate">Integrate</a>
            </li><li class="masthead__menu-item">
              <a href="/contribute">Contribute</a>
            </li><li class="masthead__menu-item">
              <a href="/blog">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/versions/1.0.0">v1 Docs (deprecated)</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      <h3>Integrate Enmeshed</h3>
      
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Getting Started</span>
        

        
        <ul>
          
            <li><a href="/integrate/basics">Basics</a></li>
          
            <li><a href="/integrate/connector-tutorial" class="active">Connector Tutorial</a></li>
          
            <li><a href="/integrate/connector-modules">Connector Modules</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Setting up the Connector</span>
        

        
        <ul>
          
            <li><a href="/integrate/connector-installation">Installation</a></li>
          
            <li><a href="/integrate/connector-configuration">Configuration</a></li>
          
            <li><a href="/integrate/connector-setup-troubleshooting">Troubleshooting</a></li>
          
            <li><a href="/integrate/error-codes">Error Codes</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">REST API</span>
        

        
        <ul>
          
            <li><a href="/integrate/connector-api">API Documentation</a></li>
          
            <li><a href="/integrate/connector-flows-messages">Sending Messages</a></li>
          
            <li><a href="/integrate/requests-over-templates">Requests over Templates</a></li>
          
            <li><a href="/integrate/requests-over-messages">Requests over Messages</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Programming</span>
        

        
        <ul>
          
            <li><a href="/integrate/connector-sdks">Connector SDKs</a></li>
          
            <li><a href="/integrate/custom-connector-modules">Custom Connector Modules</a></li>
          
            <li><a href="/integrate/connector-events">Connector Events</a></li>
          
            <li><a href="/integrate/connector-migration-v2">Migrate to v2</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Operations</span>
        

        
        <ul>
          
            <li><a href="/integrate/connector-operations">Connector Operations</a></li>
          
            <li><a href="/integrate/connector-security">Security Considerations</a></li>
          
            <li><a href="/integrate/connector-privacy">Privacy Considerations</a></li>
          
            <li><a href="/integrate/connector-performance">Performance Considerations</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Connector Tutorial">
    <meta itemprop="description" content="In this tutorial we go through the basic steps necessary to establish a Relationship to another Identity and send Messages between two Identities with an existing Relationship. This will create a better understanding of these processes, which will help you automating them for your organization.">
    <meta itemprop="datePublished" content="2022-11-23T11:36:20+01:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="/integrate/connector-tutorial" class="u-url" itemprop="url">Connector Tutorial
</a>
          </h1>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#establishing-relationships">Establishing Relationships</a><ul><li><a href="#connector-create-an-attribute">Connector: Create an Attribute</a></li><li><a href="#connector-test-your-requests-validity">Connector: Test your Request’s Validity</a></li><li><a href="#connector-create-a-relationship-template">Connector: Create a Relationship Template</a></li><li><a href="#connector-create-a-qrcode-for-the-relationship-template">Connector: Create a QRCode for the Relationship Template</a></li><li><a href="#app-send-a-relationship-request">App: Send a Relationship Request</a></li><li><a href="#connector-accept-the-relationship-request">Connector: Accept the Relationship Request</a></li></ul></li><li><a href="#sending-and-receiving-messages">Sending and Receiving Messages</a><ul><li><a href="#sending-a-message-with-a-connector">Sending a Message with a Connector</a></li><li><a href="#receiving-a-message-with-a-connector">Receiving a Message with a Connector</a></li></ul></li></ul>

            </nav>
          </aside>
        
        <p>In this tutorial we go through the basic steps necessary to establish a Relationship to another Identity and send Messages between two Identities with an existing Relationship. This will create a better understanding of these processes, which will help you automating them for your organization.</p>

<p>The following steps include small interactive pieces of the Connector’s API documentation that, when executed, fire requests on a Connector we provided for testing purposes. Example:
 <br /></p>
<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^get /health$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<p>So if you don’t have an own Connector installed, feel free to use the samples directly by unfolding them and clicking on “Try”. Otherwise you can use your own Connector either with a REST client (e.g. Insomnia or Postman) or by using the RapiDoc documentation (/docs/rapidoc) hosted on your Connector.</p>

<p>The payloads for the requests that are sent during this tutorial contain placeholders marked with <code class="language-plaintext highlighter-rouge">&lt;...&gt;</code>. You need to replace them with values before you send the request.</p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li>If you want to use your own Connector for executing the examples:
    <ul>
      <li><a href="https://enmeshed.eu/integrate/connector-installation">Install the Connector</a></li>
      <li>Make sure the <a href="https://enmeshed.eu/integrate/connector-configuration#sync">Sync Module is disabled</a> (because in this tutorial we will synchronize manually via the HTTP endpoint)</li>
      <li>Make sure the <a href="https://enmeshed.eu/integrate/connector-configuration#corehttpapi">docs are enabled</a> for the documentation route to work</li>
      <li>Get the API key that was configured during installation of the Connector (it needs to be sent in the <code class="language-plaintext highlighter-rouge">X-API-KEY</code> header of every HTTP request)</li>
    </ul>
  </li>
  <li>You need <strong>version 2</strong> of the <a href="/use">Enmeshed App</a> installed on your mobile device. <em>Since the Enmeshed v2 app is not officially released yet, you need to <a href="mailto://info@enmeshed.eu?subject=Access%20to%20the%20closed%20beta%20of%20Enmeshed%20v2">write us an email</a> with your Apple ID or the email address of your Google account you use on your phone, so we can add you to the closed beta.</em></li>
</ul>

<h2 id="establishing-relationships">Establishing Relationships</h2>

<p>In order to communicate with another Identity, a Relationship to that Identity is required. In this first part of the tutorial you will learn how to establish a Relationship between your Connector and another Identity. In this case the other Identity will be the App, but it could be another Connector as well.</p>

<h3 id="connector-create-an-attribute">Connector: Create an Attribute</h3>

<p>In order to share an Attribute via a Relationship Template, we need to create one by executing <code class="language-plaintext highlighter-rouge">POST /api/v2/Attributes</code> with the following payload:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IdentityAttribute"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;your connector's Address&gt;"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DisplayName"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Connector Tutorial"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p class="notice--info">You can query the Connector’s Address under the route <code class="language-plaintext highlighter-rouge">/api/v2/Account/IdentityInfo</code>. If you are using the Demo Connector of this Tutorial, the Address is <code class="language-plaintext highlighter-rouge">id1DpGUgSDKxiYerQ1bNbiqH8aWahTByvc6q</code>.</p>

<h6>Corresponding interactive API docs excerpt:</h6>

<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^post /api/v2/Attributes$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<table style="border: none" class="notice--warning">
    <tr>
        <td style="border: none"><i style="font-size: 2em" class="fas fa-fw fa-copy" /></td>
        <td style="border: none"><p>Save the <code class="language-plaintext highlighter-rouge">id</code> of the Attribute that you can find in the response. You will need it in the next step.</p>
</td>
    </tr>
</table>

<h3 id="connector-test-your-requests-validity">Connector: Test your Request’s Validity</h3>

<p>In order to make sure the Request and its items are valid you can validate it by calling the <code class="language-plaintext highlighter-rouge">POST /api/v2/Requests/Outgoing/Validate</code> route. You can define your own payload for this Request, or you can just use the one below, which contains two Request Item Groups:</p>

<ul>
  <li>one with a Request Item that contains Attributes that will be shared with the peer</li>
  <li>one with Request Items that query Attributes of the peer</li>
</ul>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RequestItemGroup"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"mustBeAccepted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
                </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Shared Attributes"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ShareAttributeRequestItem"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"mustBeAccepted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"attribute"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IdentityAttribute"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DisplayName"</span><span class="p">,</span><span class="w">
                                </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ConnectorV2 Demo"</span><span class="w">
                            </span><span class="p">}</span><span class="w">
                        </span><span class="p">},</span><span class="w">
                        </span><span class="nl">"sourceAttributeId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;the id of the attribute created above&gt;"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RequestItemGroup"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"mustBeAccepted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
                </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Requested Attributes"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ReadAttributeRequestItem"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"mustBeAccepted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IdentityAttributeQuery"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"valueType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GivenName"</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ReadAttributeRequestItem"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"mustBeAccepted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IdentityAttributeQuery"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"valueType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Surname"</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ReadAttributeRequestItem"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"mustBeAccepted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IdentityAttributeQuery"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"valueType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EMailAddress"</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h6>Corresponding interactive API docs excerpt:</h6>

<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^post /api/v2/Requests/Outgoing/Validate$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<h3 id="connector-create-a-relationship-template">Connector: Create a Relationship Template</h3>

<p>Start by creating a so called Relationship Template on the Connector. You can do so by calling the <code class="language-plaintext highlighter-rouge">POST /api/v2/RelationshipTemplates/Own</code> route. Use the following JSON in the request body:</p>

<div class="language-jsonc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"maxNumberOfAllocations"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"expiresAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2023-06-01T00:00:00.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RelationshipTemplateContent"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Connector Demo Contact"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"onNewRelationship"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="c1">// &lt;the value of the 'content' property validated in the previous step&gt;</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h6>Corresponding interactive API docs excerpt:</h6>

<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^post /api/v2/RelationshipTemplates/Own$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<table style="border: none" class="notice--warning">
    <tr>
        <td style="border: none"><i style="font-size: 2em" class="fas fa-fw fa-copy" /></td>
        <td style="border: none"><p>Save the <code class="language-plaintext highlighter-rouge">id</code> of the Relationship Template that you can find in the response. You will need it in the next step.</p>
</td>
    </tr>
</table>

<h3 id="connector-create-a-qrcode-for-the-relationship-template">Connector: Create a QRCode for the Relationship Template</h3>

<p>Since we will use the Enmeshed App to send a Relationship Request to the Connector, we further have to create a QR Code one can scan with the App to retrieve the Relationship Template and send a Relationship Request to the Connector.</p>

<p>For this, execute the <code class="language-plaintext highlighter-rouge">GET /api/v2/RelationshipTemplates/{id}</code> route (Accept Header: <code class="language-plaintext highlighter-rouge">image/png</code>) to create a QRCode. Use the ID of the Relationship Template from the previous step as the value for <code class="language-plaintext highlighter-rouge">id</code>.</p>

<h6>Corresponding interactive API docs excerpt:</h6>

<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^get /api/v2/RelationshipTemplates/{id}$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<h3 id="app-send-a-relationship-request">App: Send a Relationship Request</h3>

<p>Open the created QR Code and start the Enmeshed App. Depending on what you already did with the App, choose one of the following paths:</p>

<ul>
  <li>If this is the first time you use the App:
    <ul>
      <li>click on “Scan code”</li>
      <li>hold the camera in front of the QR code</li>
    </ul>
  </li>
  <li>If you want to use a new profile:
    <ul>
      <li>click on the “+ New profile” button</li>
      <li>click on “Scan code”</li>
      <li>hold the camera in front of the QR code</li>
    </ul>
  </li>
  <li>If you want to use an existing profile:
    <ul>
      <li>select the existing profile</li>
      <li>navigate to “Contacts”</li>
      <li>click on “Add contact”</li>
      <li>hold the camera in front of the QR code</li>
    </ul>
  </li>
</ul>

<p>All three paths should result in a screen similar to the one below, where you can see the information that you added as content to the Relationship Template.</p>

<p><img src="/assets/images/add-contact-screen.jpg" alt="&quot;Add contact&quot; screen" /></p>

<p>Finally, fill out the required fields and click on “Add contact” to send the Relationship Request. This will create a new Relationship between the App and the Connector. This Relationship has the status <code class="language-plaintext highlighter-rouge">Pending</code> for now.</p>

<h3 id="connector-accept-the-relationship-request">Connector: Accept the Relationship Request</h3>

<p>In order to move the Relationship into the <code class="language-plaintext highlighter-rouge">Active</code> state, you now need to accept the Relationship Request with the Connector. In order to do so, first execute the <code class="language-plaintext highlighter-rouge">POST /api/v2/Account/Sync</code> route, which will fetch all changes that occurred since the last time this endpoint was executed.</p>

<h6>Corresponding interactive API docs excerpt:</h6>

<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^post /api/v2/Account/Sync$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<p>In the response you will receive the created Relationship, which contains corresponding Relationship Creation Change.</p>

<p>Example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RELmJj25x2bZW0VXzAiQ"</span><span class="p">,</span><span class="w">
        </span><span class="err">...</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pending"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"peer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id19Sy75wjCWhQSxsbMiGLn6iSBfWvQmot5b"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"changes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RCHUwBw7BWlROPlEjb51"</span><span class="p">,</span><span class="w">
            </span><span class="err">...</span><span class="w">
            </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pending"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Creation"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<table style="border: none" class="notice--warning">
    <tr>
        <td style="border: none"><i style="font-size: 2em" class="fas fa-fw fa-copy" /></td>
        <td style="border: none"><p>Save the <code class="language-plaintext highlighter-rouge">id</code> of the Relationship (<code class="language-plaintext highlighter-rouge">REL_________________</code>) as well as the <code class="language-plaintext highlighter-rouge">id</code> of the first Relationship Change (<code class="language-plaintext highlighter-rouge">RCH_________________</code>) in the <code class="language-plaintext highlighter-rouge">changes</code> array and use them as input to the <code class="language-plaintext highlighter-rouge">PUT /api/v2/Relationships/{id}/Changes/{changeId}/Accept</code> route. You can leave that request body as it is.</p>
</td>
    </tr>
</table>

<h6>Corresponding interactive API docs excerpt:</h6>

<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^put /api/v2/Relationships/{id}/Changes/{changeId}/Accept$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<p>Now the Relationship is in the <code class="language-plaintext highlighter-rouge">Active</code> state, so we can start to communicate with the opposite Identity, which we will do in the next part of this tutorial. In order to do so we will need the Address of that Identity. So in the response of the last request look for the <code class="language-plaintext highlighter-rouge">peer</code> property and write down its value. It should start with <code class="language-plaintext highlighter-rouge">id1</code>.</p>

<h2 id="sending-and-receiving-messages">Sending and Receiving Messages</h2>

<p>After you have established a Relationship to an Identity, you can start to exchange Messages. Enmeshed defines different types of Messages. For this tutorial we will focus on Messages of type Mail, which you can compare to a classic email: you can specify one or more recipients, a subject and a body, as well as add some attachments.</p>

<h3 id="sending-a-message-with-a-connector">Sending a Message with a Connector</h3>

<p>To send a Message, all you need to do is call the <code class="language-plaintext highlighter-rouge">POST /api/v2/Messages</code> endpoint. You can use the content below, while replacing the placeholders in <code class="language-plaintext highlighter-rouge">recipients</code> and <code class="language-plaintext highlighter-rouge">to</code> with the Address you copied previously. You can further modify the <code class="language-plaintext highlighter-rouge">subject</code> and <code class="language-plaintext highlighter-rouge">body</code> properties to add some custom content.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"id_________________________________"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mail"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"to"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"id_________________________________"</span><span class="p">],</span><span class="w">
        </span><span class="nl">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello. We are pleased to welcome you as our customer."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h6>Corresponding interactive API docs excerpt:</h6>

<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^post /api/v2/Messages$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<p>After you have sent this request, you should receive a push notification on your phone. Open the Enmeshed App, navigate to “Contacts” and select your Relationship. You should see the Message in the list. You can show details by tapping on it.</p>

<h3 id="receiving-a-message-with-a-connector">Receiving a Message with a Connector</h3>

<p>Next we are going to send a Message from the App to the Connector. Therefore, open the App, navigate to “Contacts” and select your Relationship. Next, tap on “New Message”. Enter subject and body an tap on “Send”.</p>

<p>In order to fetch the Message, we need to call the <code class="language-plaintext highlighter-rouge">POST /api/v2/Account/Sync</code> endpoint again.</p>

<h6>Corresponding interactive API docs excerpt:</h6>

<rapi-doc-mini server-url="https://doc-demo-v2.is.enmeshed.eu/" default-api-server="https://doc-demo-v2.is.enmeshed.eu/" api-key-name="x-api-key" api-key-location="header" api-key-value="apikey" layout="column" default-schema-tab="example" spec-url="https://doc-demo-v2.is.enmeshed.eu/docs/json" paths-expanded="false" theme="light" bg-color="#f9f9fb" match-paths="^post /api/v2/Account/Sync$" match-type="regex"></rapi-doc-mini>
<p><br /></p>

<p>The response should contain a Message with the content you entered in the App.</p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-11-23T11:36:20+01:00">November 23, 2022</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/integrate/basics" class="pagination--pager" title="Basics
">Previous</a>
    
    
      <a href="/integrate/connector-modules" class="pagination--pager" title="Connector Modules
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
           
        <li>
            <a href="/legal" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-info" aria-hidden="true"></i> Legal Disclosure</a>
        </li>
          
        <li>
            <a href="/privacy" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-user-shield" aria-hidden="true"></i> Privacy Statement</a>
        </li>
          
        <li>
            <a href="https://www.enmeshed.eu" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a>
        </li>
          
        <li>
            <a href="https://github.com/nmshd" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a>
        </li>
          
        <li>
            <a href="https://www.npmjs.com/search?q=%40nmshd" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-npm" aria-hidden="true"></i> NPM</a>
        </li>
           
        <li>
            <a href="/feed.xml"
                ><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a
            >
        </li>
        
    </ul>
</div>

<div class="page__footer-copyright">
    &copy; 2022
    <a href="https://www.js-soft.com">j&amp;s-soft GmbH</a>. Powered by
    <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.
</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
